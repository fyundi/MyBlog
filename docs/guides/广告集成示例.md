# 广告集成示例代码

## 在文章页面添加广告

### 示例 1：文章中间插入广告

编辑 `app/posts/[slug]/page.tsx`：

```tsx
import AdBanner from '@/components/ads/AdBanner'

export default async function PostPage({ params }: PostPageProps) {
  const post = getPostBySlug(params.slug)
  
  // 将文章内容分成两部分（用于在中间插入广告）
  const contentParts = post.content.split('\n\n')
  const midPoint = Math.floor(contentParts.length / 2)
  const firstHalf = contentParts.slice(0, midPoint).join('\n\n')
  const secondHalf = contentParts.slice(midPoint).join('\n\n')

  return (
    <article>
      <header>...</header>
      
      <div className="prose">
        {/* 文章前半部分 */}
        <div dangerouslySetInnerHTML={{ __html: firstHalf }} />
        
        {/* 广告位置 */}
        <AdBanner 
          slot="你的广告位ID" 
          format="auto"
          className="my-12"
        />
        
        {/* 文章后半部分 */}
        <div dangerouslySetInnerHTML={{ __html: secondHalf }} />
      </div>
    </article>
  )
}
```

### 示例 2：文章底部广告

```tsx
<div className="prose">
  {renderContent()}
</div>

{/* 文章底部广告 */}
<AdBanner 
  slot="你的广告位ID" 
  format="horizontal"
  className="mt-12"
/>
```

### 示例 3：侧边栏广告（需要添加侧边栏布局）

创建 `components/layout/Sidebar.tsx`：

```tsx
import AdBanner from '@/components/ads/AdBanner'

export default function Sidebar() {
  return (
    <aside className="hidden lg:block w-80 ml-8">
      <div className="sticky top-24">
        <AdBanner 
          slot="你的侧边栏广告位ID" 
          format="vertical"
        />
        
        {/* 其他侧边栏内容 */}
        <div className="mt-8">
          <h3 className="font-semibold mb-4">热门文章</h3>
          {/* 热门文章列表 */}
        </div>
      </div>
    </aside>
  )
}
```

然后在文章页面使用：

```tsx
<div className="flex">
  <article className="flex-1">
    {/* 文章内容 */}
  </article>
  <Sidebar />
</div>
```

## 在首页添加广告

编辑 `app/page.tsx`：

```tsx
import AdBanner from '@/components/ads/AdBanner'

export default function Home() {
  return (
    <div>
      {/* 分类部分 */}
      <section>...</section>
      
      {/* 分类和文章之间的广告 */}
      <AdBanner 
        slot="你的首页广告位ID" 
        format="horizontal"
        className="my-12"
      />
      
      {/* 文章列表 */}
      <section>...</section>
    </div>
  )
}
```

## 在文章列表页添加广告

编辑 `app/posts/page.tsx`：

```tsx
import AdBanner from '@/components/ads/AdBanner'

export default function PostsPage() {
  const posts = getAllPosts()
  
  return (
    <div>
      <h1>所有文章</h1>
      
      <div className="grid gap-6">
        {posts.map((post, index) => (
          <>
            <PostCard key={post.slug} post={post} />
            
            {/* 每 5 篇文章插入一个广告 */}
            {(index + 1) % 5 === 0 && (
              <AdBanner 
                slot="你的列表页广告位ID" 
                format="horizontal"
              />
            )}
          </>
        ))}
      </div>
    </div>
  )
}
```

## 环境变量配置

### 本地开发

创建 `.env.local` 文件：

```env
NEXT_PUBLIC_ADSENSE_ID=ca-pub-xxxxxxxxxx
```

### Vercel 部署

1. 在 Vercel 项目设置中
2. 点击 "Settings" → "Environment Variables"
3. 添加：
   - **Name**: `NEXT_PUBLIC_ADSENSE_ID`
   - **Value**: 你的 AdSense 发布商 ID
   - **Environment**: Production, Preview, Development（全选）

## 广告位置最佳实践

### 高收益位置（按优先级）

1. **文章内容中间** - 阅读中，注意力集中
2. **文章开头** - 阅读前，高曝光
3. **侧边栏** - 桌面端，不影响阅读
4. **文章列表** - 浏览时，自然融入
5. **文章底部** - 阅读后，可能相关推荐

### 注意事项

1. **不要过度**：每篇文章最多 2-3 个广告
2. **不影响阅读**：广告不要打断阅读流程
3. **响应式设计**：确保移动端体验良好
4. **遵守政策**：遵守 AdSense 内容政策

## 测试广告显示

### 开发环境

```bash
npm run dev
```

访问文章页面，检查广告是否正确显示。

### 生产环境

1. 部署到 Vercel
2. 访问生产环境 URL
3. 使用 AdSense 的"广告预览工具"验证

## 监控和优化

1. **AdSense 后台**：
   - 查看点击率（CTR）
   - 查看每千次展示收入（RPM）
   - 分析最佳广告位置

2. **A/B 测试**：
   - 测试不同广告位置
   - 测试不同广告格式
   - 优化用户体验

3. **持续优化**：
   - 根据数据调整广告位置
   - 优化内容质量
   - 提升用户体验
